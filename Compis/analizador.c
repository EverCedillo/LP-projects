#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int matrizeition [41][25]={
	{1,-1,4,2,-1,-1,-1,5,-1,3,-1,-1,6,7,-1,11,15,15,15,13,12,14,9,10,8},
{-1,24,-1,25,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,20,-1,16,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,-1,27,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,30,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,33,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,37},
{-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,37},
{-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,37},
{-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,39,13,13,13,13,13,13,13,13},
{40,40,40,40,40,40,40,40,40,40,40,40,-1,-1,40,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,17,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,-1,-1,-1,-1,18,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,-1,-1,-1,19,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,-1,-1,22,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,23,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,26,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,-1,28,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,29,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,31,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,-1,-1,-1,32,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,-1,-1,-1,-1,34,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,-1,-1,-1,35,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
{40,40,40,40,40,40,40,40,40,40,40,40,40,-1,40,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
};
int CHARS[]={'i',	'n','t','f','l','o','a','e','s','b','r','u'};
int posibilitie();
void error(char*buffer);
int cathToken(char*buffer,int status);
int find(char c);
int main(int argc, char const *argv[]){
	/* code */
	char *buffer,c;
	int status=0,lexic_element,pre_status,flag=-1;
	FILE * file;
	file =fopen(argv[1],"r");
	buffer=(char*)malloc(sizeof(char)*2);
	printf("holi %s\n",argv[1] );
	if(file!=NULL){
		while(feof(file)==0){
			c=flag==0?c:fgetc(file);
			status=c==EOF?-1:status;
			lexic_element=find(c);
			//printf("%c,status:%d,%d-%s, flag:%d\n",c,status,lexic_element,buffer,flag);
			
			if(lexic_element!=-1){
				status=matrizeition[status][lexic_element];
				}
			else if(c!=EOF){
				error(buffer);
				status=0;
				flag=1;
			}
			if(status==-1){
				if(cathToken(buffer,pre_status))
				flag=status=pre_status=0;
				free(buffer);
				buffer=(char*)malloc(sizeof(char)*2);
			}else{
				char tmp2 [2] = {c, '\0'};
				strcat ( buffer , tmp2 );
				pre_status=status;
				flag=1;
			}
			
		}
	}

	return 0;
}
int lex(int state){

}
void error(char*buffer){
	printf("Errir\n");
}
int cathToken(char*buffer,int status){
	switch(status){
		case 26: //int
		case 25: //if
		case 32: //true
		case 23: //float
		case 19: //false
		case 35: //else
		case 27: //bool
			printf("%s: Palabra reservadeishon",buffer);
		break;
		case 6: //ENTERO
			printf("%s: ENTERO\n",buffer);
		break;
		case 36: //REAL
			printf("%s: REAL\n",buffer);
		break;
		case 11: //ARITMETICO
			printf("%s: ARITMETICO\n",buffer);
		break;
		case 12: //ESPECIALES
			printf("%s: SEPARADORES\n",buffer);
		break;
		case 40: //ID's
			printf("%s: IDENTIFICADOR\n",buffer);
			break;
		case 8:
		case 9:
		case 10:
		case 37: //OP RElacionales
			printf("%s: RELACIONALES\n",buffer);
			break;
		case EOF:
			printf("END OF FILE\n");
			break;
		default:
			return -1;
		return 0;
	}
}
int find(char c){
	int i=0;
	for(i=0;i<12;i++){
		if(c==CHARS[i])
			return i;
	}
	if(47<=c&&57>=c)
		return 12;
	if(c=='.')
		return 13;
	if((65<=c&&90>=c)||(97<=c&&122>=c))
		return 14;
	if(c==43||c==45||c==42||c==47)
		return 15;
	if(c=='\n')
		return 16;
	if(c=='\t')
		return 17;
	if(c==' ')
		return 18;
	if(c=='#')
		return 19;
	if(c=='{'||c=='}'||c=='('||c==')')
		return 20;
	if(c=='@')
		return 21;
	if(c=='>')
		return 22;
	if(c=='<')
		return 23;
	if(c=='=')
		return 24;
	return -1;
}

